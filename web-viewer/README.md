# UNI'S ON AIR ランキングビューアー

## 概要
UNI'S ON AIR Speed Trackerで収集したランキングデータを表示・分析するWebツールです。
CSVデータを使用して詳細な時間差分析が可能です。

## アクセス方法

### 方法1: GUIアプリから起動
1. メインアプリケーションを起動
2. 右パネルの「Region Rankings」の横にある「ビューアーを開く」ボタンをクリック
3. 自動的にブラウザが開きます（http://localhost:8080/web-viewer/）

### 方法2: Webサーバーモードで起動
```bash
go run main.go --web
```
ブラウザで http://localhost:8080 にアクセス

## 機能

### データ読み込み
- **リージョン選択**: リージョン名は.envファイルの設定値を自動取得
  - `REGION_X_NAME` 環境変数から動的に表示
  - 未設定の場合は「リージョン X」をデフォルト表示
- **データ形式**: CSVデータのみ（時間差分析込み）

### フィルタリング
- **プレイヤー名検索**: 部分一致検索
- **順位フィルタ**: 
  - 1-10位
  - 11-50位
  - 51-100位
  - 101-500位
- **ポイント範囲**: 最小値〜最大値で絞り込み

### ソート機能
- 全カラムでソート可能（クリックで昇順/降順切替）
  - 日時
  - 順位
  - プレイヤー名
  - ポイント

### 拡張された時間差分析
**1画面で全期間の差分表示に最適化**
- 1h, 3h, 6h, 9h, 12h, 15h, 18h, 21h, 24h
- 36h(1.5d), 48h(2d), 60h(2.5d), 72h(3d), 84h(3.5d), 96h(4d)
- 108h(4.5d), 120h(5d), 132h(5.5d), 144h(6d), 156h(6.5d), 168h(7d), 180h(7.5d)
- 増加は緑色、減少は赤色で表示
- コンパクト表示で最大180h(7.5d)まで1画面表示対応

### 統計表示
- 総レコード数
- フィルタ後の表示件数
- 最終更新日時
- 最大上昇ポイント
- 最大下降ポイント
- 平均変動

### エクスポート
- フィルタ結果をCSVファイルとしてダウンロード
- 全22カラムの時間差分データを含む完全なエクスポート

## 新機能・改善点

### v2.0 の主な変更点
- **JSONサポート廃止**: CSVデータ専用に簡素化
- **拡張時間差分**: 180h(7.5d)まで22カラムの差分表示
- **動的リージョン名**: .env設定からリージョン名を自動取得
- **1画面最適化**: 横幅最大活用でコンパクト表示
- **API統合**: `/api/regions` エンドポイントでリージョン情報取得

### 表示最適化
- **フォントサイズ**: 12px→11px（ヘッダー）、11px（データ）
- **セル間隔**: 最小化でデータ密度向上
- **レスポンシブ**: モバイル表示でも全カラム対応

## ディレクトリ構成
```
web-viewer/
├── index.html       # メインページ
├── script.js        # JavaScript処理
├── style.css        # スタイルシート
└── README.md        # このファイル

res/
├── 1/
│   ├── screenshot/  # スクリーンショット画像
│   ├── json/        # JSON データファイル
│   └── csv/         # CSV データファイル（メイン使用）
├── 2/
└── ...（Region 3-6）
```

## 技術仕様
- **フロントエンド**: 純粋なHTML/CSS/JavaScript（フレームワーク不使用）
- **バックエンド**: Go HTTPサーバー + REST API
- **データ形式**: CSV（26カラム：基本情報4 + 時間差分22）
- **レスポンシブデザイン**: デスクトップ・タブレット・モバイル対応
- **ブラウザサポート**: モダンブラウザ（Chrome, Firefox, Safari, Edge）

## API仕様

### GET /api/regions
リージョン名一覧を取得

**レスポンス例:**
```json
{
  "1": "メインステージ",
  "2": "サブステージ",
  "3": "リージョン 3",
  "4": "リージョン 4",
  "5": "リージョン 5",
  "6": "リージョン 6"
}
```

## トラブルシューティング

### データが読み込めない場合
1. メインアプリケーションまたはWebサーバーが起動していることを確認
2. HTTPサーバー（http://localhost:8080）が動作していることを確認
3. 対象リージョンのCSVファイル(`res/X/csv/datas.csv`)が存在することを確認
4. ブラウザの開発者ツールでネットワークエラーを確認

### 表示が崩れる場合
- ブラウザのキャッシュをクリア（Ctrl+F5 または Cmd+Shift+R）
- 最新のブラウザを使用しているか確認
- 画面幅が狭い場合は横スクロールで全カラム表示

### リージョン名が「リージョン X」のまま表示される場合
- .envファイルに `REGION_X_NAME=カスタム名` を設定
- アプリケーションを再起動してAPIが最新設定を反映することを確認